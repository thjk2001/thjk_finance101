---
title: "Macro Dashboard"
format: html
editor: source
---


```{r}
library(fredr)
library(dplyr)
library(zoo)
library(tidyverse)
library(ggplot2)
library(lubridate)
library(readxl)
library(tidyr)
library(tidyquant)

fredr_set_key("da613fe30b4aba9f426b578cc2e5d192")
```

# Big Fources


## Productivity Growth

**Real GDP per capita (1947-2025)**
```{r}
# Fetch real GDP per capita (chained 2017 USD)
gdp_pc <- fredr(
  series_id = "A939RX0Q048SBEA",
  observation_start = as.Date("1947-01-01")
)

# Plot 1: Raw GDP per capita level
ggplot(gdp_pc, aes(x = date, y = value)) +
  geom_line(color = "steelblue", size = 1) +
  labs(
    title = "Real GDP Per Capita (USA)",
    subtitle = "Chained 2017 Dollars, Quarterly",
    x = "Date", y = "USD",
    caption = "Source: FRED (A939RX0Q048SBEA)"
  ) +
  theme_minimal()

```


**Real GDP per capita %YOY (1947-2025)**
```{r}
# Calculate YoY growth
gdp_pc <- gdp_pc %>%
  mutate(
    yoy_growth = (value / lag(value, 4) - 1) * 100
  )

# Plot 2: YoY growth
ggplot(filter(gdp_pc, !is.na(yoy_growth)), aes(x = date, y = yoy_growth)) +
  geom_line(color = "darkgreen", size = 1) +
  labs(
    title = "YoY Growth of Real GDP Per Capita",
    subtitle = "Chained 2017 Dollars, Quarterly YOY Change (%)",
    x = "Date", y = "Percent",
    caption = "Source: FRED (A939RX0Q048SBEA)"
  ) +
  theme_minimal()
```


**Maddison Project: Real GDP per capita %YOY (1800-2025)**
```{r}

# Read GDPpc sheet using the correct header row (row 3)
maddison_us_gdppc2023 <- read_excel("maddison_project_2023db.xlsx", sheet = "GDPpc", skip = 2)

# Extract year and USA GDP per capita
us_gdp_yoy <- maddison_us_gdppc2023 %>%
  select(year, real_gdp_per_capita = USA) %>%
  filter(year >= 1800) %>%
  mutate(
    real_gdp_per_capita = as.numeric(real_gdp_per_capita),
    yoy_growth = (real_gdp_per_capita / lag(real_gdp_per_capita) - 1) * 100
  ) %>%
  filter(!is.na(yoy_growth))

# Plot YoY growth
ggplot(us_gdp_yoy, aes(x = year, y = yoy_growth)) +
  geom_line(color = "steelblue", size = 1) +
  labs(
    title = "US Real GDP per Capita: Year-over-Year Growth (%)",
    subtitle = "Source: Maddison Project Database (2023, GDPpc sheet)",
    x = "Year", y = "YoY % Growth"
  ) +
  theme_minimal()

```


Supplement: Real GPD per capita (actual figures)
```{r}
library(ggplot2)

# Plot real GDP per capita (level, not YoY)
ggplot(us_gdp_yoy, aes(x = year, y = real_gdp_per_capita)) +
  geom_line(color = "darkgreen", size = 1) +
  labs(
    title = "US Real GDP per Capita (2011 USD, Maddison Data)",
    subtitle = "Source: Maddison Project Database (2023, GDPpc sheet)",
    x = "Year", y = "Real GDP per Capita"
  ) +
  theme_minimal()

```


## Short-Term Debt Cycle

### Credit Growth

**Total Credit to Private Sector (1943-2025)**

+ Tracks the amount of outstanding credit (loans + debt securities) held by households and nonfinancial corporations
+ Excludes government and financial-sector borrowing
```{r}
# Total Credit to Private Non-Financial Sector
total_credit <- fredr(
  series_id = "TOTALSL",
  frequency = "q",                  # quarterly
  aggregation_method = "eop",       # end of period
  observation_start = as.Date("1943-01-01")
)

# Plot level of Total Credit to Private Sector
ggplot(total_credit, aes(x = date, y = value)) +
  geom_line(color = "steelblue", size = 1) +
  labs(
    title = "Total Credit to Private Non-Financial Sector (Level)",
    subtitle = "FRED Series: TOTALSL | Quarterly",
    x = "Date", y = "Billions of USD"
  ) +
  theme_minimal()

```


**Total Credit to Private Sector %YOY (1944-2025)**
```{r}
total_credit <- total_credit %>%
  mutate(
    yoy_growth = (value / lag(value, 4) - 1) * 100
  ) %>%
  filter(!is.na(yoy_growth))

# Plot
ggplot(total_credit, aes(x = date, y = yoy_growth)) +
  geom_line(color = "steelblue", size = 1) +
  labs(
    title = "YoY Growth: Total Credit to Private Sector",
    subtitle = "FRED Series: TOTALSL | Quarterly YOY Change (%)",
    x = "Date", y = "Year-over-Year Growth (%)"
  ) +
  theme_minimal()
```



**Household Credit (1945-2025)**

+ Household borrowing activity, reflecting consumer confidence, credit availability, and macroeconomic conditions
+ Mortgage loans (largest component) and consumer credit, including credit card debt, auto loans, student debt, and personal loans
```{r}
# Household Credit (Consumer Credit Outstanding)
household_credit <- fredr(
  series_id = "HCCSDODNS",
  frequency = "q",
  aggregation_method = "eop",
  observation_start = as.Date("1945-01-01")
)

# Plot level of Household Credit
ggplot(household_credit, aes(x = date, y = value)) +
  geom_line(color = "darkred", size = 1) +
  labs(
    title = "Household Credit Outstanding (Level)",
    subtitle = "FRED Series: HCCSDODNS | Quarterly",
    x = "Date", y = "Billions of USD"
  ) +
  theme_minimal()

```


**Household Credit %YOY (1946-2025)**
```{r}

household_credit <- household_credit %>%
  mutate(
    yoy_growth = (value / lag(value, 4) - 1) * 100
  ) %>%
  filter(!is.na(yoy_growth))

# Plot
ggplot(household_credit, aes(x = date, y = yoy_growth)) +
  geom_line(color = "darkred", size = 1) +
  labs(
    title = "YoY Growth: Household Credit",
    subtitle = "FRED Series: HCCSDODNS | Quarterly YOY Change (%)",
    x = "Date", y = "Year-over-Year Growth (%)"
  ) +
  theme_minimal()

```



**Nonfinancial Corporate Business Debt (1945-2025)**

+ U.S. non‑financial corporate businesses only (excludes households, government, banks, insurers, etc.)
+ All outstanding loans plus debt‑securities (corporate bonds, commercial paper)
```{r}
# Fetch non-financial corporate debt (level, quarterly EOP)
nonfin_corp_debt <- fredr(
  series_id = "BCNSDODNS",
  frequency = "q",
  aggregation_method = "eop",
  observation_start = as.Date("1945-01-01")
)

# Plot raw level
ggplot(nonfin_corp_debt, aes(x = date, y = value)) +
  geom_line(color = "darkblue", size = 1) +
  labs(
    title = "Nonfinancial Corporate Debt (Level)",
    subtitle = "FRED Series: BCNSDODNS | Quarterly, End of Period",
    x = "Date", y = "Billions USD"
  ) +
  theme_minimal()


```

**Nonfinancial Corporate Business Debt %YOY (1946-2025)**
```{r}
# Calculate YoY growth
nonfin_corp_debt <- nonfin_corp_debt %>%
  mutate(
    yoy_growth = (value / lag(value, 4) - 1) * 100
  ) %>%
  filter(!is.na(yoy_growth))

# Plot YoY growth
ggplot(nonfin_corp_debt, aes(x = date, y = yoy_growth)) +
  geom_line(color = "darkblue", size = 1) +
  labs(
    title = "YoY Growth: Nonfinancial Corporate Debt",
    subtitle = "FRED Series: BCNSDODNS | Quarterly, YOY Change (%)",
    x = "Date", y = "% YoY"
  ) +
  theme_minimal()


```




**Total Credit Market Debt/Nominal GDP (1947-2025)**

+ Total credit market debt: Includes all debt owed by the U.S. economy: federal, state/local, households, corporations, and nonprofits (captures overall leverage in the economy)
+ Debt to GDP ratio: High ratios suggest financial fragility or dependence on credit
```{r}
# Fetch Total Credit Market Debt Outstanding
tcmdo <- fredr(
  series_id = "TCMDO",
  frequency = "q",
  aggregation_method = "eop",
  observation_start = as.Date("1945-01-01")
)

# Fetch Nominal GDP
nominal_gdp <- fredr(
  series_id = "GDP",
  frequency = "q",
  observation_start = as.Date("1947-01-01")
)

```

**Nominal GDP (1947-2025)**
```{r}
ggplot(nominal_gdp, aes(x = date, y = value)) +
  geom_line(color = "steelblue", size = 1) +
  labs(
    title = "Nominal GDP (GDP)",
    subtitle = "Billions of USD | Quarterly",
    x = "Date", y = "Billions USD"
  ) +
  theme_minimal()


```

**Total Credit Market Debt (1945-2025)**
```{r}
ggplot(tcmdo, aes(x = date, y = value)) +
  geom_line(color = "darkred", size = 1) +
  labs(
    title = "Total Credit Market Debt Outstanding (TCMDO)",
    subtitle = "Billions of USD | Quarterly, End of Period",
    x = "Date", y = "Billions USD"
  ) +
  theme_minimal()


```

**Debt to GDP ratio (1947-2025)**
```{r}
# Merge and calculate ratio
debt_gdp <- left_join(tcmdo, nominal_gdp, by = "date", suffix = c("_tcmdo", "_gdp")) %>%
  mutate(debt_to_gdp = (value_tcmdo / value_gdp) * 100)

# Plot ratio
ggplot(debt_gdp, aes(x = date, y = debt_to_gdp)) +
  geom_line(color = "darkgreen", size = 1) +
  labs(
    title = "Total Credit Market Debt as % of Nominal GDP",
    subtitle = "TCMDO / GDP | Quarterly",
    x = "Date", y = "Debt-to-GDP (%)"
  ) +
  theme_minimal()

```



### PMI

To be continued...



### Yield Curve

**10yr-2yr Yield Curve Spread (1976-2025)**

+ Normal yield curve: Long-term rates > short-term rates = economy expected to grow
+ Inverted curve (spread < 0): Short-term rates > long-term = investors expect rate cuts or recession
```{r}
# Fetch yield curve spread (10Y - 2Y), monthly
yield_spread <- fredr(
  series_id = "T10Y2Y",
  frequency = "m",
  observation_start = as.Date("1976-06-01")
)

# Plot yield curve spread
ggplot(yield_spread, aes(x = date, y = value)) +
  geom_line(color = "darkblue", size = 1) +
  labs(
    title = "Yield Curve Spread: 10Y Treasury - 2Y Treasury",
    subtitle = "FRED Series: T10Y2Y | Monthly",
    x = "Date", y = "Spread (%)"
  ) +
  theme_minimal()


```

**10yr and 2yr Yield Curves (1976-2025)**
```{r}
# Fetch 10Y Treasury yield
yield_10y <- fredr(
  series_id = "GS10",
  frequency = "m",
  observation_start = as.Date("1976-06-01")
)

# Fetch 2Y Treasury yield
yield_2y <- fredr(
  series_id = "GS2",
  frequency = "m",
  observation_start = as.Date("1976-06-01")
)

# Combine the two into one dataset
yields <- full_join(yield_10y, yield_2y, by = "date", suffix = c("_10y", "_2y")) %>%
  select(date, value_10y, value_2y) %>%
  pivot_longer(cols = c(value_10y, value_2y),
               names_to = "maturity",
               values_to = "yield") %>%
  mutate(maturity = recode(maturity,
                           "value_10y" = "10-Year Yield",
                           "value_2y" = "2-Year Yield"))

# Plot both yields
ggplot(yields, aes(x = date, y = yield, color = maturity)) +
  geom_line(size = 1) +
  labs(
    title = "10-Year vs. 2-Year Treasury Yields",
    subtitle = "FRED Series: GS10 and GS2 | Monthly",
    x = "Date", y = "Yield (%)", color = "Maturity"
  ) +
  theme_minimal()


```



### Unemployment

**U-3 Unemployment**

+ % of labor force actively seeking work
+ Primary indicator of unemployment; signals labor market slack
```{r}
# Unemployment Rate (U‑3)
unrate <- fredr(
  series_id = "UNRATE",
  frequency = "m",
  observation_start = as.Date("1948-01-01")
)

ggplot(unrate, aes(x = date, y = value)) +
  geom_line(color = "steelblue", size = 1) +
  labs(
    title = "U‑3 Unemployment Rate",
    subtitle = "FRED Series: UNRATE | Monthly",
    x = "Date", y = "Percent"
  ) +
  theme_minimal()

```


**Labor Force Participation**

+ % of working-age population in labor force
+ Measures labor market engagement; declines may signal discouragement or aging
```{r}
# Labor‑Force Participation Rate
lf_part <- fredr(
  series_id = "CIVPART",
  frequency = "m",
  observation_start = as.Date("1948-01-01")
)

ggplot(lf_part, aes(x = date, y = value)) +
  geom_line(color = "darkgreen", size = 1) +
  labs(
    title = "Labor‑Force Participation Rate",
    subtitle = "FRED Series: CIVPART | Monthly",
    x = "Date", y = "Percent"
  ) +
  theme_minimal()

```


**Employment-Population Ratio**

+ % of population currently employed
+ Tracks overall employment strength, independent of participation rate
```{r}
# Employment‑to‑Population Ratio
emp_ratio <- fredr(
  series_id = "EMRATIO",
  frequency = "m",
  observation_start = as.Date("1948-01-01")
)

ggplot(emp_ratio, aes(x = date, y = value)) +
  geom_line(color = "purple", size = 1) +
  labs(
    title = "Employment‑Population Ratio",
    subtitle = "FRED Series: EMRATIO | Monthly",
    x = "Date", y = "Percent"
  ) +
  theme_minimal()

```


**Broad Unemployment (U‑6)**

+ Broadest unemployment (includes marginal workers)
+ Captures underemployment and discouraged workers; useful in downturns
```{r}
# U‑6 Unemployment Rate (broader measure)
u6rate <- fredr(
  series_id = "U6RATE",
  frequency = "m",
  observation_start = as.Date("1994-01-01")  # first year available
)

ggplot(u6rate, aes(x = date, y = value)) +
  geom_line(color = "firebrick", size = 1) +
  labs(
    title = "U‑6 Unemployment Rate",
    subtitle = "FRED Series: U6RATE | Monthly",
    x = "Date", y = "Percent"
  ) +
  theme_minimal()

```



## Long-term debt cycle

### Leverage Metrics

**Total Public Debt/Nominal GDP (1966-2025)**

+ Tracks how much the government owes relative to the size of the economy
```{r}
public_debt_gdp <- fredr(
  series_id = "GFDEGDQ188S",
  frequency = "q",
  observation_start = as.Date("1966-01-01")
)

ggplot(public_debt_gdp, aes(x = date, y = value)) +
  geom_line(color = "darkblue", size = 1) +
  labs(
    title = "Total Public Debt as % of GDP",
    subtitle = "FRED Series: GFDEGDQ188S | Quarterly",
    x = "Date", y = "Percent of GDP"
  ) +
  theme_minimal()

```
Include YOY for Total Public Debt


**Household Credit/Nominal GDP (1947-2025)**

+ Measures household leverage — an indicator of consumer financial health
+ A key component of private sector debt buildup in long-term debt cycles
```{r}
# Join household credit and nominal GDP by date
household_credit_gdp <- left_join(household_credit, nominal_gdp, by = "date", suffix = c("_debt", "_gdp")) %>%
  mutate(
    ratio = value_debt / value_gdp * 100  # Convert to percentage
  )

# Plot the ratio
ggplot(household_credit_gdp, aes(x = date, y = ratio)) +
  geom_line(color = "darkorange", size = 1) +
  labs(
    title = "Household Credit as % of Nominal GDP",
    subtitle = "HCCSDODNS / GDP | Quarterly",
    x = "Date", y = "Ratio (%)"
  ) +
  theme_minimal()

```


**Total Nonfinancial Corporate Debt/Nominal GDP (1947-2025)**

+ Total credit market debt of nonfinancial sectors, including corporate, household, and state/local government, relative to GDP
+ Captures overall leverage in the nonfinancial private sector (broader measure than BCNSDODNS)
+ A broad gauge of debt burdens that may limit investment or amplify financial instability
```{r}
tcmdodns <- fredr(
  series_id = "TCMDODNS",
  frequency = "q",
  observation_start = as.Date("1945-01-01")
)

ggplot(tcmdodns, aes(x = date, y = value)) +
  geom_line(color = "darkred", size = 1) +
  labs(
    title = "Total Credit Market Debt - Nonfinancial Sectors (TCMDODNS)",
    subtitle = "Quarterly | Billions of USD",
    x = "Date", y = "Debt Level (Billions)"
  ) +
  theme_minimal()


```


```{r}
nonfin_credit_gdp <- left_join(tcmdodns, nominal_gdp, by = "date", suffix = c("_debt", "_gdp")) %>%
  mutate(
    ratio = value_debt / value_gdp * 100  # % of GDP
  )

ggplot(nonfin_credit_gdp, aes(x = date, y = ratio)) +
  geom_line(color = "steelblue", size = 1) +
  labs(
    title = "Total Nonfinancial Sector Credit as % of Nominal GDP",
    subtitle = "TCMDODNS / GDP | Quarterly",
    x = "Date", y = "Ratio (%)"
  ) +
  theme_minimal()

```
Include YOY for TCMDODNS


**Total Credit to Private Nonfinancial Sector/Nominal GDP (1947-2024)**

+ BIS-reported ratio of credit to households and nonfinancial corporations (i.e., the private nonfinancial sector) as a % of GDP
+ Only private sector (no state/local government)
```{r}
bis_priv_credit_ratio <- fredr(
  series_id = "QUSPAM770A",
  frequency = "q",
  observation_start = as.Date("1947-01-01")
)

ggplot(bis_priv_credit_ratio, aes(x = date, y = value)) +
  geom_line(color = "forestgreen", size = 1) +
  labs(
    title = "Total Credit to Private Nonfinancial Sector as % of GDP",
    subtitle = "Source: BIS (QUSPAM770A) | Quarterly",
    x = "Date", y = "Ratio (%)"
  ) +
  theme_minimal()


```



**Loans and Leases in Bank Credit (1973-2025)**

+ Total value of loans and leases held by all U.S. commercial banks. It shows the amount of credit extended by the banking sector
+ Reflects bank credit creation, a key part of the monetary transmission mechanism
```{r}
totll <- fredr(
  series_id = "TOTLL",
  frequency = "q",
  observation_start = as.Date("1973-01-01"),
  aggregation_method = "eop"
)

ggplot(totll, aes(x = date, y = value)) +
  geom_line(color = "purple", size = 1) +
  labs(
    title = "Loans and Leases in Bank Credit (End of Period)",
    subtitle = "TOTLL | All Commercial Banks | Quarterly | Billions USD",
    x = "Date", y = "Level (Billions)"
  ) +
  theme_minimal()


```
Include YOY for TOTLL



### Gov Fiscal Condition

**Federal Debt Held by Public (1970-2025)**
```{r}
# Federal Debt Held by Public
fed_debt_public <- fredr(
  series_id = "FYGFDPUN",
  frequency = "q",
  aggregation_method = "eop",
  observation_start = as.Date("1970-01-01")
)

ggplot(fed_debt_public, aes(x = date, y = value)) +
  geom_line(color = "darkred", size = 1) +
  labs(title = "Federal Debt Held by Public",
       subtitle = "FYGFDPUN | Quarterly",
       y = "Billions USD", x = "Date") +
  theme_minimal()


```

```{r}
# Calculate year‑over‑year growth for Federal Debt Held by Public
fed_debt_public <- fed_debt_public %>%         # assumes quarterly frequency
  mutate(
    yoy_growth = (value / lag(value, 4) - 1) * 100
  ) %>%
  filter(!is.na(yoy_growth))

# Plot YoY growth
ggplot(fed_debt_public, aes(x = date, y = yoy_growth)) +
  geom_line(color = "darkred", size = 1) +
  labs(
    title = "YoY Growth: Federal Debt Held by the Public",
    subtitle = "FRED Series: FYGFDPUN | Quarterly YOY Change (%)",
    x = "Date", y = "Percent YoY"
  ) +
  theme_minimal()

```

**Federal Debt Held by Public / GDP (1970-2025)**

+ Debt that’s traded in public markets as % of GDP
+ Reflects the true burden of U.S. government borrowing on financial markets and the economy
```{r}
# Fetch Federal Debt Held by Public / GDP (ratio)
fed_debt_gdp_ratio <- fredr(
  series_id = "FYGFGDQ188S",
  frequency = "q",
  observation_start = as.Date("1970-01-01")  # first available quarter
)

# Plot ratio
ggplot(fed_debt_gdp_ratio, aes(x = date, y = value)) +
  geom_line(color = "steelblue", size = 1) +
  labs(
    title = "Federal Debt Held by Public as % of GDP",
    subtitle = "FRED Series: FYGFGDQ188S | Quarterly",
    x = "Date", y = "Debt‑to‑GDP (%)"
  ) +
  theme_minimal()

```



**Federal Government Budget Deficit (1980-2025)**
```{r}
# Federal Budget Deficit
fed_budget_deficit <- fredr(
  series_id = "MTSDS133FMS",
  frequency = "q",
  aggregation_method = "eop",
  observation_start = as.Date("1980-01-01")
)

ggplot(fed_budget_deficit, aes(x = date, y = value)) +
  geom_line(color = "navy", size = 1) +
  labs(title = "Federal Government Budget Deficit",
       subtitle = "FRED Series: MTSDS133FMS | Quarterly, End of Period",
       y = "Millions USD", x = "Date") +
  theme_minimal()

```

Annual version (1901-2025)
```{r}
# Fetch federal surplus or deficit
annual_fed_budget_deficit <- fredr(
  series_id = "FYFSD",
  observation_start = as.Date("1945-01-01")
)

# Plot the budget deficit (note: negative = deficit)
ggplot(annual_fed_budget_deficit, aes(x = date, y = value)) +
  geom_line(color = "firebrick", size = 1) +
  labs(
    title = "Federal Budget Surplus or Deficit (Annual)",
    subtitle = "FRED Series: FYFSD | Millions USD",
    x = "Date", y = "Budget Balance (Millions)"
  ) +
  geom_hline(yintercept = 0, linetype = "dashed") +
  theme_minimal()

```



**Federal Receipts as % of GDP (1929-2025)**

+ All revenues collected by the U.S. federal government (mainly taxes and custom duties)
+ How much of the nation’s economic output is being captured by federal revenue
```{r}
# Federal Receipts as % of GDP
fed_receipts_gdpratio <- fredr(
  series_id = "FYFRGDA188S",
  observation_start = as.Date("1929-01-01")
)

ggplot(fed_receipts_gdpratio, aes(x = date, y = value)) +
  geom_line(color = "darkgreen", size = 1) +
  labs(title = "Federal Receipts (% of GDP)",
       subtitle = "FRED Series: FYFRGDA188S | Annual",
       y = "% of GDP", x = "Date") +
  theme_minimal()

```



**Total Federal Outlays as % of GDP (1929-2025)**

+ Total spending by the federal government (Social Security, Medicare, Medicaid Defense and discretionary programs, Interest payments on debt, Emergency or stimulus measures)
+ Size of government spending relative to the economy
```{r}
# Fetch Federal Outlays as % of GDP
fed_outlays_gdpratio <- fredr(
  series_id = "FYOIGDA188S",
  observation_start = as.Date("1940-01-01")
)

# Plot the ratio
ggplot(fed_outlays_gdpratio, aes(x = date, y = value)) +
  geom_line(color = "darkblue", size = 1) +
  labs(
    title = "Federal Outlays as % of Nominal GDP",
    subtitle = "FRED Series: FYFOGDA188S | Annual",
    x = "Date", y = "Outlays / GDP (%)"
  ) +
  theme_minimal()

```



### Monetary Response Capacity

**Fed Balance Sheet Size**

+ Total holdings of assets by the Federal Reserve (Treasuries, MBS, repos, etc.)
+ A proxy for the degree of monetary intervention or liquidity support
+ Expands during crises: QE, bailouts, asset purchases
+ Larger balance sheet = less policy room (future QE becomes harder without inflation or financial distortions)
```{r}
# Fed Balance Sheet Size (WALCL)
fed_balance_sheet <- fredr(
  series_id = "WALCL",
  observation_start = as.Date("2002-01-01")  # earlier data is less complete
)

ggplot(fed_balance_sheet, aes(x = date, y = value)) +
  geom_line(color = "steelblue", size = 1) +
  labs(title = "Fed Balance Sheet Size",
       subtitle = "WALCL | Weekly | Millions of USD",
       y = "Millions USD", x = "Date") +
  theme_minimal()

```

Fed Balance Sheet YOY
```{r}
# Calculate YoY growth for monthly Fed balance sheet
fed_balance_sheet_yoy <- fed_balance_sheet %>%
  mutate(yoy = (value / lag(value, 12) - 1) * 100) %>%
  filter(!is.na(yoy))

# Plot YoY
ggplot(fed_balance_sheet_yoy, aes(x = date, y = yoy)) +
  geom_line(color = "steelblue", size = 1) +
  labs(
    title = "Federal Reserve Balance Sheet (YoY Growth)",
    subtitle = "WALCL | Monthly Year-over-Year Change (%)",
    x = "Date", y = "YoY Growth (%)"
  ) +
  theme_minimal()

```




**M2 Money Supply**

+ Includes: M1 (cash + demand deposits) plus savings deposits, time deposits < $100K, money market funds
+ Proxy for liquidity and money creation
+ Limitation: Doesn’t directly track credit or shadow banking
```{r}
# M2 Money Supply
m2_supply <- fredr(
  series_id = "M2SL",
  frequency = "m",
  observation_start = as.Date("1959-01-01")
)

ggplot(m2_supply, aes(x = date, y = value)) +
  geom_line(color = "darkgreen", size = 1) +
  labs(title = "M2 Money Supply",
       subtitle = "M2SL | Monthly | Billions of USD",
       y = "Billions USD", x = "Date") +
  theme_minimal()

```

M2 YOY
```{r}
# Calculate YoY growth for M2 money supply
m2_supply_yoy <- m2_supply %>%
  mutate(yoy = (value / lag(value, 12) - 1) * 100) %>%  # 12 months = 1 year
  filter(!is.na(yoy))

# Plot YoY
ggplot(m2_supply_yoy, aes(x = date, y = yoy)) +
  geom_line(color = "forestgreen", size = 1) +
  labs(
    title = "M2 Money Supply (YoY Growth)",
    subtitle = "M2SL | Monthly Year-over-Year Change (%)",
    x = "Date", y = "YoY Growth (%)"
  ) +
  theme_minimal()

```



**Core PCE Inflation**

+ Fed’s preferred inflation gauge (Tracks consumption inflation excluding volatile food and energy prices)
+ Direct input to monetary policy decisions. More stable and forward-looking than headline CPI
+ 2% target
```{r}
core_pce <- fredr(
  series_id = "PCEPILFE",
  frequency = "m",
  observation_start = as.Date("1959-01-01")
)

# Calculate YoY inflation
core_pce <- core_pce %>%
  mutate(
    core_pce_yoy = (value / lag(value, 12) - 1) * 100
  ) %>%
  filter(!is.na(core_pce_yoy))

# Plot YoY Core PCE inflation
ggplot(core_pce, aes(x = date, y = core_pce_yoy)) +
  geom_line(color = "firebrick", size = 1) +
  labs(
    title = "Core PCE Inflation (YoY)",
    subtitle = "PCEPILFE | Monthly | Year-over-Year (%)",
    x = "Date",
    y = "Percent Change (YoY)",
    caption = "Source: FRED (PCEPILFE)"
  ) +
  theme_minimal()
```


**CPI YoY Inflation**

+ Traditional, well-known headline inflation measure
+ Tracks changes in prices paid by urban consumers for a fixed basket of goods/services
+ Key driver of wage negotiations, cost-of-living adjustments. While not the Fed's official target, CPI shocks strongly influence public inflation expectations
```{r}
# CPI YoY Inflation
cpi <- fredr(
  series_id = "CPIAUCSL",
  frequency = "m",
  observation_start = as.Date("1947-01-01")
) %>%
  mutate(
    cpi_yoy = (value / lag(value, 12) - 1) * 100
  ) %>%
  filter(!is.na(cpi_yoy))

ggplot(cpi, aes(x = date, y = cpi_yoy)) +
  geom_line(color = "orange", size = 1) +
  labs(title = "CPI YoY Inflation",
       subtitle = "CPIAUCSL | Monthly | Year-over-Year (%)",
       y = "% YoY", x = "Date") +
  theme_minimal()

```



# Three Equilibria

1. Debt growth is in line with income growth that is required to service the debts
2. Economic capacity utilization is neither too high nor too low
3. Projected returns of equities are above the projected returns of bonds which are above the projected returns of cash by appropriate risk premiums


## Debt Growth vs Income Growth

**Household level:**

+ Household Debt / Disposable Income
+ Household Debt Service Ratio: interest + principal payments as % of disposable income


**Corporate Level**

+ Corporate Debt / EBITDA
+ Corporate Debt / Net Profit
+ Corporate Debt / Revenue
+ Corporate Debt / EBIT
+ Corporate Debt Service Ratio: interest payments as % of EBITDA or profit


**Federal Level**

+ Public Debt / Nominal GDP
+ Interest Payments / Federal Receipts


## Capacity Utilization

+ Capacity Utilization Rate (CAPUTLB00004SQ)
+ Unemployment rate vs. natural rate
+ Output gap (actual GDP vs. potential GDP)



## Relationship between Projected Risk Premiums of Different Asset Classes

+ Equity risk premium = S&P 500 earnings yield − 10Y Treasury yield
+ Bond term premium = 10Y − 2Y Treasury yield
+ Corp. bonds vs Treasuries
+ 30Y, 10Y, 5Y, 2Y spreads
+ Cash return = Fed Funds Rate or 3-month T-bill yield
